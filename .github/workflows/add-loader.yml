name: Add Infinite Loader
on: [push]
jobs:
  add-loader:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Setup Python
        uses: actions/setup-python@v2
        with:
          python-version: 3.9
      - name: Add loader to all pages
        run: |
          pip install beautifulsoup4
          python -c "
          from bs4 import BeautifulSoup
          import os
          BLOCK = '''[ВСТАВЬ HTML-БЛОК СВЕРХУ ЗДЕСЬ]'''
          for filename in os.listdir('pages'):
            if filename.endswith('.html'):
              with open(f'pages/{filename}', 'r', encoding='utf-8') as f:
                soup = BeautifulSoup(f.read(), 'html.parser')
              body = soup.find('body')
              if body:
                body.append(BeautifulSoup(BLOCK, 'html.parser'))
              with open(f'pages/{filename}', 'w', encoding='utf-8') as f:
                f.write(str(soup))
              print(f'✓ Добавлено в {filename}')
          "
      - name: Commit changes
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add pages/*
          git commit -m "Add infinite loader to all 2500 pages"
          git push
